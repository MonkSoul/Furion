---
id: deploy-docker
title: 34.2 åœ¨ Docker éƒ¨ç½²
sidebar_label: 34.2 åœ¨ Docker éƒ¨ç½²
---

import useBaseUrl from "@docusaurus/useBaseUrl";

:::tip ç²¾ç®€å‘å¸ƒæ–‡ä»¶

å¦‚æœéœ€è¦ç²¾ç®€å‘å¸ƒåçš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯åˆ é™¤ä¸å¿…è¦çš„æ–‡ä»¶å¤¹ï¼Œå¯ä»¥ç¼–è¾‘ Web é¡¹ç›®çš„ `.csproj` å¹¶æ·»åŠ  `<SatelliteResourceLanguages>en-US</SatelliteResourceLanguages>`ï¼Œå¦‚ï¼š

```cs showLineNumbers  {3}
<PropertyGroup>
  <TargetFramework>net6.0</TargetFramework>
  <SatelliteResourceLanguages>en-US</SatelliteResourceLanguages>
</PropertyGroup>
```

:::

## 34.2.1 å…³äº `Docker` éƒ¨ç½²

åœ¨ `Docker` ä¸­éƒ¨ç½²ç½‘ç«™æœ‰ä¸¤ç§æ–¹å¼ï¼š

- `å‘å¸ƒåæ„å»º`ï¼šæ­¤æ–¹å¼æ˜¯å…ˆå‘å¸ƒç½‘ç«™ååœ¨å†æ„å»ºé•œåƒï¼Œè¿™æ ·å¯ä»¥å‡å°‘ä¸å¿…è¦çš„æ„å»ºå±‚ï¼Œè€Œä¸”è¿˜èƒ½ç¼©å‡é•œåƒå¤§å°ã€‚**ï¼ˆæ¨èï¼‰**
- `ç¼–è¯‘+æ„å»º+å‘å¸ƒ`ï¼šä¹Ÿå°±æ˜¯è¯´åœ¨ `Dockerfile` ä¸­é…ç½®ç½‘ç«™ä»æ„å»ºåˆ°å‘å¸ƒçš„å®Œæ•´è¿‡ç¨‹ï¼Œæ­¤æ–¹å¼ä¼šé€Ÿåº¦æ…¢ï¼Œè€Œä¸”ä¼šäº§ç”Ÿå†—ä½™å±‚ï¼Œå¢åŠ é•œåƒå¤§å°ã€‚

## 34.2.2 ä¸¤ç§æ–¹å¼æ„å»º

### 34.2.2.1 å‘å¸ƒåæ„å»º

- ğŸ‘‰ å‘å¸ƒç½‘ç«™

é¦–å…ˆåœ¨ `Visual Studio` æˆ– `dotnet cli` ä¸­å‘å¸ƒç½‘ç«™ï¼Œå¯ä»¥å‚è€ƒ [åœ¨ IIS éƒ¨ç½²-å‘å¸ƒç½‘ç«™](deploy-iis#3411-å‘å¸ƒç½‘ç«™)

- ğŸ‘‰ ç¼–å†™ `Dockerfile`

```bash showLineNumbers
FROM mcr.microsoft.com/dotnet/aspnet:7.0
WORKDIR /app
EXPOSE 80
EXPOSE 443

COPY . .
ENTRYPOINT ["dotnet", "Furion.Web.Entry.dll"]
```

- ğŸ‘‰ å°† `Dockerfile` æ–‡ä»¶æ‹·è´åˆ°å‘å¸ƒæ ¹ç›®å½•

å°†ç¼–å†™å¥½çš„ `Dockerfile` æ–‡ä»¶ï¼ˆæ³¨æ„ `D` å¤§å†™ï¼‰æ‹·è´åˆ°å‘å¸ƒç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ã€‚

- ğŸ‘‰ æ„å»º `Docker` é•œåƒ

åœ¨ç½‘ç«™å‘å¸ƒåçš„è·¯å¾„æ ¹ç›®å½•ä¸‹ï¼ˆå¿…é¡»å« `Dockerfile`ï¼‰æ‰“å¼€ `CMD/PowerShell` åªéœ€æ„å»ºå‘½ä»¤ï¼š

```bash showLineNumbers
docker build -t ç½‘ç«™åç§°:ç½‘ç«™ç‰ˆæœ¬å· .
```

:::important ç‰¹åˆ«æ³¨æ„

åç«¯çš„ `.` ä¸èƒ½çœç•¥

:::

- ğŸ‘‰ å¯åŠ¨é•œåƒ

```bash showLineNumbers
docker run --name å®¹å™¨åç§° -p 5000:80 --restart=always -d ç½‘ç«™åç§°:ç½‘ç«™ç‰ˆæœ¬å·
```

:::tip å‘å¸ƒåˆ° `hub.docker.com`

å¦‚æœéœ€è¦å°†è¯¥ç½‘ç«™çš„é•œåƒå…¬å¼€å‡ºå»ï¼Œé‚£ä¹ˆå¯ä»¥å‘å¸ƒåˆ° `hub.docker.com` ä¸­ã€‚å‘å¸ƒæ­¥éª¤å¦‚ä¸‹ï¼š

- ğŸ‘‰ ä¸ºé•œåƒæ‰“ `tag` æ ‡ç­¾

```bash showLineNumbers
docker tag ç½‘ç«™åç§°:ç½‘ç«™ç‰ˆæœ¬å· dockerè´¦å·å/ç½‘ç«™åç§°:ç½‘ç«™ç‰ˆæœ¬å·
```

å¦‚ï¼š

```bash showLineNumbers
docker tag furion:v2.20 monksoul/furion:v2.20
```

- ğŸ‘‰ ç™»å½• `docker`

```bash showLineNumbers
docker login
```

- ğŸ‘‰ æ¨é€åˆ° `hub.docker.com`

```bash showLineNumbers
docker push dockerè´¦å·å/ç½‘ç«™åç§°:ç½‘ç«™ç‰ˆæœ¬å·
```

å¦‚ï¼š

```bash showLineNumbers
docker push monksoul/furion:v2.20
```

:::

### 34.2.2.2 ç¼–è¯‘+æ„å»º+å‘å¸ƒ

æ­¤æ–¹å¼å¯ä»¥å·æ‡’ï¼Œä½†æ˜¯ä¸å¤ªæ¨èï¼Œä¸è¿‡åœ¨æŸäº›åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ï¼Œå°±æ˜¯é›†æˆ `Devops` å·¥å…·é“¾å¯ä»¥åšåˆ°ä¸€æ­¥åˆ°ä½ã€‚

- ğŸ‘‰ ç¼–å†™ `Dockerfile`

è¿™ç§æ–¹å¼åªéœ€è¦æŠŠ `Dockerfile` å†…å®¹æ›¿æ¢æˆä»¥ä¸‹å³å¯ï¼š

```bash showLineNumbers  {6}
FROM mcr.microsoft.com/dotnet/sdk:5.0.9 AS build
WORKDIR /source

# Download Source
RUN git init
RUN git remote add -t master -m master origin ä½ çš„æºç Gitåœ°å€
RUN git config core.sparseCheckout true
RUN echo samples >> .git/info/sparse-checkout
RUN git pull --depth 1 origin main

# Restore And Publish
WORKDIR /source/samples
RUN dotnet restore
RUN dotnet publish -c release -o /app --no-restore

# Run
FROM mcr.microsoft.com/dotnet/aspnet:5.0.9
WORKDIR /app
COPY --from=build /app ./
EXPOSE 80
EXPOSE 443
ENTRYPOINT ["dotnet", "Furion.Web.Entry.dll"]
```

- ğŸ‘‰ åœ¨ `Dockerfile` æ‰€åœ¨è·¯å¾„æ„å»º

æ¥ä¸‹æ¥çš„æ­¥éª¤å’Œä¸Šè¿°æ­¥éª¤ä¸€è‡´ï¼Œä¸å†é‡å¤ç¼–å†™ã€‚

## 34.2.3 åé¦ˆä¸å»ºè®®

:::note ä¸æˆ‘ä»¬äº¤æµ

ç»™ Furion æ [Issue](https://gitee.com/dotnetchina/Furion/issues/new?issue)ã€‚

:::
