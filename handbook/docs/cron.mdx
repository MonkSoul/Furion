---
id: cron
title: 26.2 Cron è¡¨è¾¾å¼
sidebar_label: 26.2 Cron è¡¨è¾¾å¼
---

import Tag from "@site/src/components/Tag.js";

<details>
  <summary>ğŸ“ æ¨¡å—æ›´æ–°æ—¥å¿—</summary>
  <div>
<div>

- **æ–°ç‰¹æ€§**

  - &nbsp;<Tag>æ–°å¢</Tag> `Crontab.IsValid(...)` é™æ€æ–¹æ³•ï¼Œåˆ¤æ–­ `Cron` è¡¨è¾¾å¼æ˜¯å¦æœ‰æ•ˆ <sup>4.8.7.17</sup> <sup>â±ï¸2023.03.20</sup> [#I6OHO4](https://gitee.com/dotnetchina/Furion/issues/I6OHO4)
  - &nbsp;<Tag>æ–°å¢</Tag> `crontab.GetSleepTimeSpan(baseTime)` å®ä¾‹æ–¹æ³• <sup>4.8.4.10</sup> <sup>â±ï¸2023.01.09</sup> [#I69HM4](https://gitee.com/dotnetchina/Furion/issues/I69HM4)
  - &nbsp;<Tag>æ–°å¢</Tag> `Crontab.ParseAt(..)` é™æ€æ–¹æ³• <sup>4.8.2.6</sup> <sup>â±ï¸2022.11.30</sup> [035cc23](https://gitee.com/dotnetchina/Furion/commit/035cc23a20045e9673a1406b94e72030f5f18375)
  - &nbsp;<Tag>æ–°å¢</Tag> `Crontab` æ‰€æœ‰ `Macro At` é™æ€æ–¹æ³• <sup>4.8.2.6</sup> <sup>â±ï¸2022.11.30</sup> [a15b69d](https://gitee.com/dotnetchina/Furion/commit/a15b69d0eeb4bdc8d0ec042cfec22ff0049dc89f)
  - &nbsp;<Tag>æ–°å¢</Tag> `Crontab.Workday` è¡¨ç¤ºå‘¨ä¸€è‡³å‘¨äº”çš„ `Macro` é™æ€å±æ€§ <sup>4.8.2.6</sup> <sup>â±ï¸2022.11.30</sup> [a15b69d](https://gitee.com/dotnetchina/Furion/commit/a15b69d0eeb4bdc8d0ec042cfec22ff0049dc89f)

- **é—®é¢˜ä¿®å¤**

  - &nbsp;<Tag>ä¿®å¤</Tag> `Cron` è¡¨è¾¾å¼æ­¥é•¿è§£æå™¨é”™è¯¯ <sup>4.8.8.25</sup> <sup>â±ï¸2023.06.14</sup> [#I7D9XU](https://gitee.com/dotnetchina/TimeCrontab/issues/I7D9XU)
  - &nbsp;<Tag>ä¿®å¤</Tag> `Cron` è¡¨è¾¾å¼ `*` ç¬¦å·è§£æå™¨ä¸å¤Ÿä¸¥è°¨ï¼Œå¦‚ï¼š`*1111aaaaa` ä¹Ÿè¢«è§£æä¸º `*` <sup>4.8.7.17</sup> <sup>â±ï¸2023.03.20</sup> [#I6OHO4](https://gitee.com/dotnetchina/Furion/issues/I6OHO4)

</div>
  </div>
</details>

import useBaseUrl from "@docusaurus/useBaseUrl";

:::warning ç‰ˆæœ¬è¯´æ˜

åœ¨ `Furion 4.8.0+` ç‰ˆæœ¬é‡‡ç”¨ [TimeCrontab](https://gitee.com/dotnetchina/TimeCrontab) ä½œä¸º `Cron` è¡¨è¾¾å¼è§£æã€‚

:::

:::important ç‰ˆæœ¬è¯´æ˜

ä»¥ä¸‹å†…å®¹ä»…é™ `Furion 4.8.0 +` ç‰ˆæœ¬ä½¿ç”¨ã€‚

:::

## 26.2.1 å…³äº `Cron` è¡¨è¾¾å¼

`Cron` è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä»¥ `5` æˆ– `6` ä¸ªç©ºæ ¼éš”å¼€ï¼Œåˆ†ä¸º `6` æˆ– `7` ä¸ªåŸŸï¼Œæ¯ä¸€ä¸ªåŸŸä»£è¡¨ä¸€ä¸ªå«ä¹‰ï¼Œ`Cron` è¡¨è¾¾å¼é€šå¸¸æ˜¯ä½œä¸ºå®ç°å®šæ—¶ä»»åŠ¡çš„åŸºçŸ³ã€‚

<img src={useBaseUrl("img/cron.png")} />

## 26.2.2 å¿«é€Ÿå…¥é—¨

### 26.2.2.1 å¸¸è§„æ ¼å¼

**å¸¸è§„æ ¼å¼**ï¼šåˆ† æ—¶ å¤© æœˆ å‘¨

```cs showLineNumbers {1}
var crontab = Crontab.Parse("* * * * *");
var nextOccurrence = crontab.GetNextOccurrence(DateTime.Now);
```

### 26.2.2.2 æ”¯æŒå¹´ä»½

**æ”¯æŒå¹´ä»½**ï¼šåˆ† æ—¶ å¤© æœˆ å‘¨ å¹´

```cs showLineNumbers {1}
var crontab = Crontab.Parse("* * * * * *", CronStringFormat.WithYears);
var nextOccurrence = crontab.GetNextOccurrence(DateTime.Now);
```

### 26.2.2.3 æ”¯æŒç§’æ•°

**æ”¯æŒç§’æ•°**ï¼šç§’ åˆ† æ—¶ å¤© æœˆ å‘¨

```cs showLineNumbers {1}
var crontab = Crontab.Parse("* * * * * *", CronStringFormat.WithSeconds);
var nextOccurrence = crontab.GetNextOccurrence(DateTime.Now);
```

### 26.2.2.4 æ”¯æŒç§’å’Œå¹´

**æ”¯æŒç§’å’Œå¹´**ï¼šç§’ åˆ† æ—¶ å¤© æœˆ å‘¨ å¹´

```cs showLineNumbers {1}
var crontab = Crontab.Parse("* * * * * * *", CronStringFormat.WithSecondsAndYears);
var nextOccurrence = crontab.GetNextOccurrence(DateTime.Now);
```

### 26.2.2.5 `Macro` æ ‡è¯†ç¬¦å’Œé™æ€å±æ€§

ä¸ºäº†æ–¹ä¾¿å¸¸è§çš„ `Cron` è¡¨è¾¾å¼ï¼Œå¦‚ `æ¯å¤©`ï¼Œ`æ¯æœˆ`ï¼Œ`æ¯å°æ—¶` ç­‰ç­‰ï¼Œæ‰€ä»¥æä¾›äº† `Macro` æ ‡è¯†ç¬¦å’Œé™æ€å±æ€§ï¼š

```cs showLineNumbers {1,11}
// macro å­—ç¬¦ä¸²
var secondly = Crontab.Parse("@secondly");    // æ¯ç§’ .0000000
var minutely = Crontab.Parse("@minutely");    // æ¯åˆ†é’Ÿ 00
var hourly = Crontab.Parse("@hourly");    // æ¯å°æ—¶ 00:00
var daily = Crontab.Parse("@daily");  // æ¯å¤© 00:00:00
var monthly = Crontab.Parse("@monthly");  // æ¯æœˆ 1 å· 00:00:00
var weekly = Crontab.Parse("@weekly");    // æ¯å‘¨æ—¥ 00ï¼š00ï¼š00
var yearly = Crontab.Parse("@yearly");    // æ¯å¹´ 1 æœˆ 1 å· 00:00:00
var workday = Crontab.Parse("@workday");    // æ¯å‘¨ä¸€è‡³å‘¨äº” 00:00:00

// é™æ€å±æ€§
var secondly = Crontab.Secondly;    // æ¯ç§’ .0000000
var minutely = Crontab.Minutely;    // æ¯åˆ†é’Ÿ 00
var hourly = Crontab.Hourly;    // æ¯å°æ—¶ 00:00
var daily = Crontab.Daily;  // æ¯å¤© 00:00:00
var monthly = Crontab.Monthly;  // æ¯æœˆ 1 å· 00:00:00
var weekly = Crontab.Weekly;    // æ¯å‘¨æ—¥ 00ï¼š00ï¼š00
var yearly = Crontab.Yearly;    // æ¯å¹´ 1 æœˆ 1 å· 00:00:00
var workday = Crontab.Workday;    // æ¯å‘¨ä¸€è‡³å‘¨äº” 00:00:00
```

### 26.2.2.6 `Macro At` æ ‡è¯†ç¬¦

```cs showLineNumbers
// æ¯ç¬¬ 3 ç§’
var crontab = Crontab.SecondlyAt(3);
// æ¯ç¬¬ 3ï¼Œ5ï¼Œ6 ç§’
var crontab = Crontab.SecondlyAt(3, 5, 6);

// æ¯åˆ†é’Ÿç¬¬ 3 ç§’
var crontab = Crontab.MinutelyAt(3);
// æ¯åˆ†é’Ÿç¬¬ 3ï¼Œ5ï¼Œ6 ç§’
var crontab = Crontab.MinutelyAt(3, 5, 6);

// æ¯å°æ—¶ç¬¬ 3 åˆ†é’Ÿ
var crontab = Crontab.HourlyAt(3);
// æ¯å°æ—¶ç¬¬ 3ï¼Œ5ï¼Œ6 åˆ†é’Ÿ
var crontab = Crontab.HourlyAt(3, 5, 6);

// æ¯å¤©ç¬¬ 3 å°æ—¶æ­£ï¼ˆç‚¹ï¼‰
var crontab = Crontab.DailyAt(3);
// æ¯å¤©ç¬¬ 3ï¼Œ5ï¼Œ6 å°æ—¶æ­£ï¼ˆç‚¹ï¼‰
var crontab = Crontab.DailyAt(3, 5, 6);

// æ¯æœˆç¬¬ 3 å¤©é›¶ç‚¹æ­£
var crontab = Crontab.MonthlyAt(3);
// æ¯æœˆç¬¬ 3ï¼Œ5ï¼Œ6 å¤©é›¶ç‚¹æ­£
var crontab = Crontab.MonthlyAt(3, 5, 6);

// æ¯å‘¨æ˜ŸæœŸ 3 é›¶ç‚¹æ­£
var crontab = Crontab.WeeklyAt(3);
var crontab = Crontab.WeeklyAt("WED");  // SUNï¼ˆæ˜ŸæœŸå¤©ï¼‰ï¼ŒMONï¼ŒTUEï¼ŒWEDï¼ŒTHUï¼ŒFRIï¼ŒSAT
// æ¯å‘¨æ˜ŸæœŸ 3ï¼Œ5ï¼Œ6 é›¶ç‚¹æ­£
var crontab = Crontab.WeeklyAt(3, 5, 6);
var crontab = Crontab.WeeklyAt("WED", "FRI", "SAT");
// è¿˜æ”¯æŒæ··åˆ
var crontab = Crontab.WeeklyAt(3, "FRI", 6);

// æ¯å¹´ç¬¬ 3 æœˆ 1 æ—¥é›¶ç‚¹æ­£
var crontab = Crontab.YearlyAt(3);
var crontab = Crontab.YearlyAt("MAR");  // JANï¼ˆä¸€æœˆï¼‰ï¼ŒFEBï¼ŒMARï¼ŒAPRï¼ŒMAYï¼ŒJUNï¼ŒJULï¼ŒAUGï¼ŒSEPï¼ŒOCTï¼ŒNOVï¼ŒDEC
// æ¯å¹´ç¬¬ 3ï¼Œ5ï¼Œ6 æœˆ 1 æ—¥é›¶ç‚¹æ­£
var crontab = Crontab.YearlyAt(3);
var crontab = Crontab.YearlyAt(3, 5, 6);
var crontab = Crontab.YearlyAt("MAR", "MAY", "JUN");
// è¿˜æ”¯æŒæ··åˆ
var crontab = Crontab.YearlyAt(3, "MAY", 6);
```

## 26.2.3 `Cron` å„å­—æ®µè¯´æ˜

| å­—æ®µ                                | å…è®¸å€¼              | å…è®¸ç‰¹åˆ«ç¬¦å·     | æ ¼å¼åŒ–                                                                   |
| ----------------------------------- | ------------------- | ---------------- | ------------------------------------------------------------------------ |
| ç§’ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   | `0-59`              | `\* , - /`       | `CronStringFormat.WithSeconds` æˆ– `CronStringFormat.WithSecondsAndYears` |
| åˆ†é’Ÿ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | `0-59`              | `\* , - /`       | `ALL`                                                                    |
| å°æ—¶ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | `0-23`              | `\* , - /`       | `ALL`                                                                    |
| å¤© &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   | `1-31`              | `\* , - / ? L W` | `ALL`                                                                    |
| æœˆä»½ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | `1-12` or `JAN-DEC` | `\* , - /`       | `ALL`                                                                    |
| æ˜ŸæœŸ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | `0-6` or `SUN-SAT`  | `\* , - / ? L #` | `ALL`                                                                    |
| å¹´ä»½ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | `0001â€“9999`         | `\* , - /`       | `CronStringFormat.WithYears` æˆ– `CronStringFormat.WithSecondsAndYears`   |

- `*`ï¼šè¡¨ç¤ºåŒ¹é…è¯¥åŸŸçš„ä»»æ„å€¼ï¼Œå‡å¦‚åœ¨ `åˆ†é’Ÿ` åŸŸä½¿ç”¨ `*`ï¼Œå³è¡¨ç¤ºæ¯åˆ†é’Ÿéƒ½ä¼šè§¦å‘äº‹ä»¶ã€‚
- `?`ï¼šåªèƒ½ç”¨åœ¨ `å¤©` å’Œ `æ˜ŸæœŸ` ä¸¤ä¸ªåŸŸã€‚å®ƒä¹ŸåŒ¹é…åŸŸçš„ä»»æ„å€¼ï¼Œä½†å®é™…ä¸ä¼šã€‚å› ä¸º `å¤©` å’Œ `æ˜ŸæœŸ` ä¼šç›¸äº’å½±å“ã€‚ä¾‹å¦‚æƒ³åœ¨ `æ¯æœˆçš„20æ—¥` è§¦å‘è°ƒåº¦ï¼Œä¸ç®¡ 20 æ—¥åˆ°åº•æ˜¯æ˜ŸæœŸå‡ ï¼Œåˆ™åªèƒ½ä½¿ç”¨å¦‚ä¸‹å†™æ³•ï¼š`13 13 15 20 * ?`, å…¶ä¸­æœ€åä¸€ä½åªèƒ½ç”¨ `?`ï¼Œè€Œä¸èƒ½ä½¿ç”¨ `*`ï¼Œå¦‚æœä½¿ç”¨ `*` è¡¨ç¤ºä¸ç®¡æ˜ŸæœŸå‡ éƒ½ä¼šè§¦å‘ï¼Œå®é™…ä¸Šå¹¶ä¸æ˜¯è¿™æ ·ã€‚
- `-`ï¼šè¡¨ç¤ºèŒƒå›´ï¼Œä¾‹å¦‚åœ¨ `åˆ†é’Ÿ` åŸŸä½¿ç”¨ `5-20`ï¼Œè¡¨ç¤ºä» `5åˆ†` åˆ°`20åˆ†é’Ÿ` æ¯åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ã€‚
- `/`ï¼šè¡¨ç¤ºèµ·å§‹æ—¶é—´å¼€å§‹è§¦å‘ï¼Œç„¶åæ¯éš”å›ºå®šæ—¶é—´è§¦å‘ä¸€æ¬¡ï¼Œä¾‹å¦‚åœ¨ `åˆ†é’Ÿ` åŸŸä½¿ç”¨ `5/20`ï¼Œåˆ™æ„å‘³ç€ `5åˆ†é’Ÿ` è§¦å‘ä¸€æ¬¡ï¼Œè€Œ `25ï¼Œ45` ç­‰åˆ†åˆ«è§¦å‘ä¸€æ¬¡ã€‚
- `,`ï¼šè¡¨ç¤ºåˆ—å‡ºæšä¸¾å€¼ã€‚ä¾‹å¦‚ï¼šåœ¨ `åˆ†é’Ÿ` åŸŸä½¿ç”¨ `5,20`ï¼Œåˆ™æ„å‘³ç€åœ¨ `ç¬¬5` å’Œ `ç¬¬20åˆ†é’Ÿ` åˆ†åˆ«è§¦å‘ä¸€æ¬¡ã€‚
- `L`ï¼šè¡¨ç¤ºæœ€åï¼Œåªèƒ½å‡ºç°åœ¨ `æ˜ŸæœŸ` å’Œ `æœˆä»½` åŸŸï¼Œå¦‚æœåœ¨ `æ˜ŸæœŸ` åŸŸä½¿ç”¨ `5L`ï¼Œæ„å‘³ç€åœ¨ `æœ€åçš„ä¸€ä¸ªæ˜ŸæœŸå››` è§¦å‘ã€‚
- `W`ï¼šè¡¨ç¤ºæœ‰æ•ˆå·¥ä½œæ—¥(å‘¨ä¸€åˆ°å‘¨äº”),åªèƒ½å‡ºç°åœ¨ `å¤©` åŸŸï¼Œç³»ç»Ÿå°†åœ¨ç¦»æŒ‡å®šæ—¥æœŸçš„æœ€è¿‘çš„æœ‰æ•ˆå·¥ä½œæ—¥è§¦å‘äº‹ä»¶ã€‚ä¾‹å¦‚ï¼šåœ¨ `å¤©` ä½¿ç”¨ `5W`ï¼Œå¦‚æœ `5æ—¥æ˜¯æ˜ŸæœŸå…­ï¼Œåˆ™å°†åœ¨æœ€è¿‘çš„å·¥ä½œæ—¥ï¼šæ˜ŸæœŸäº”ï¼Œå³ 4æ—¥ è§¦å‘`ã€‚å¦‚æœ `5æ—¥æ˜¯æ˜ŸæœŸå¤©ï¼Œåˆ™åœ¨6æ—¥(å‘¨ä¸€)è§¦å‘`ï¼›å¦‚æœ `5æ—¥åœ¨æ˜ŸæœŸä¸€åˆ°æ˜ŸæœŸäº”ä¸­çš„ä¸€å¤©ï¼Œåˆ™å°±åœ¨ 5æ—¥ è§¦å‘`ã€‚å¦å¤–ä¸€ç‚¹ï¼Œ`W` çš„æœ€è¿‘å¯»æ‰¾ä¸ä¼šè·¨è¿‡æœˆä»½ã€‚
- `LW`ï¼šè¿™ä¸¤ä¸ªå­—ç¬¦å¯ä»¥è¿ç”¨ï¼Œè¡¨ç¤ºåœ¨æŸä¸ªæœˆæœ€åä¸€ä¸ªå·¥ä½œæ—¥ï¼Œå³æœ€åä¸€ä¸ªéå‘¨å…­å‘¨æœ«çš„æ—¥æœŸã€‚
- `#`ï¼šç”¨äºç¡®å®šæ¯ä¸ªæœˆç¬¬å‡ ä¸ªæ˜ŸæœŸå‡ ï¼Œåªèƒ½å‡ºç°åœ¨ `æ˜ŸæœŸ` åŸŸã€‚ä¾‹å¦‚åœ¨ `2#3`ï¼Œè¡¨ç¤ºæŸæœˆçš„ç¬¬äºŒä¸ªæ˜ŸæœŸä¸‰ã€‚

## 26.2.4 `CronStringFormat` æ ¼å¼åŒ–

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`Cron` è¡¨è¾¾å¼ä¸æ”¯æŒ `ç§’` å’Œ `å¹´` çš„ï¼Œå¦‚æœ‰éœ€æ±‚ï¼Œå¯é…ç½® `CronStringFormat` æšä¸¾å‚æ•°ã€‚

- `CronStringFormat` æä¾›ä»¥ä¸‹æšä¸¾å€¼ï¼š
  - `CronStringFormat.Default`ï¼šé»˜è®¤æ ¼å¼ï¼Œä¹¦å†™é¡ºåºï¼š`åˆ† æ—¶ å¤© æœˆ å‘¨`
  - `CronStringFormat.WithYears`ï¼šå¸¦å¹´ä»½æ ¼å¼ï¼Œä¹¦å†™é¡ºåºï¼š`åˆ† æ—¶ å¤© æœˆ å‘¨ å¹´`
  - `CronStringFormat.WithSeconds`ï¼šå¸¦ç§’æ ¼å¼ï¼Œä¹¦å†™é¡ºåºï¼š`ç§’ åˆ† æ—¶ å¤© æœˆ å‘¨`
  - `CronStringFormat.WithSecondsAndYears`ï¼šå¸¦ç§’å’Œå¹´æ ¼å¼ï¼Œä¹¦å†™é¡ºåºï¼š`ç§’ åˆ† æ—¶ å¤© æœˆ å‘¨ å¹´`

## 26.2.5 åœ¨çº¿ç”Ÿæˆ `Cron` è¡¨è¾¾å¼

å¯¹äºå¤§å¤šæ•°å¼€å‘è€…æ¥è¯´ï¼Œç¼–å†™ `Cron` è¡¨è¾¾å¼æ˜¯æœ‰éš¾åº¦çš„ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨åœ¨çº¿ `Cron` è¡¨è¾¾å¼ç”Ÿæˆå™¨ã€‚

[https://cron.qqe2.com/](https://cron.qqe2.com/)

## 26.2.6 å®ç°ç®€å•å®šæ—¶ä»»åŠ¡

:::tip å°å»ºè®®

å»ºè®®ä½¿ç”¨ ã€[26.1 è°ƒåº¦ä½œä¸š](/docs/job)ã€‘ ç« èŠ‚å†…å®¹å®ç°å¼ºå¤§çš„åˆ†å¸ƒå¼å®šæ—¶ä»»åŠ¡ã€‚

:::

é€šè¿‡ `Cron` è¡¨è¾¾å¼è§£æå’Œ `while` å¾ªç¯å¯ä»¥å®ç°ç®€å•çš„å®šæ—¶ä»»åŠ¡ã€‚

### 26.2.6.1 `while` + `Task` æ–¹å¼

```cs showLineNumbers {2-3,5,10-11,13,15,18}
// é˜»å¡æ–¹å¼
var crontab = Crontab.Parse("* * * * * *", CronStringFormat.WithSeconds);
while(true)
{
    Thread.Sleep(crontab.GetSleepMilliseconds(DateTime.Now));
    Console.WriteLine(DateTime.Now.ToString("G"));
}

// æ— é˜»å¡æ–¹å¼
var crontab = Crontab.Parse("* * * * * *", CronStringFormat.WithSeconds);
Task.Factory.StartNew(async () =>
{
    while (true)
    {
        await Task.Delay(crontab.GetSleepMilliseconds(DateTime.Now));
        Console.WriteLine(DateTime.Now.ToString("G"));
    }
}, TaskCreationOptions.LongRunning);
```

### 26.2.6.2 `BackgroundService` æ–¹å¼

```cs showLineNumbers {1,8,13,20-21,30}
using Furion.TimeCrontab;

namespace WorkerService;

public class Worker : BackgroundService
{
    private readonly ILogger<Worker> _logger;
    private readonly Crontab _crontab;

    public Worker(ILogger<Worker> logger)
    {
        _logger = logger;
        _crontab = Crontab.Parse("* * * * * *", CronStringFormat.WithSeconds);
    }

    protected override async Task ExecuteAsync(CancellationToken stoppingToken)
    {
        while (!stoppingToken.IsCancellationRequested)
        {
            var taskFactory = new TaskFactory(System.Threading.Tasks.TaskScheduler.Current);
            await taskFactory.StartNew(async () =>
            {
                // ä½ çš„ä¸šåŠ¡ä»£ç å†™åˆ°è¿™é‡Œé¢

                _logger.LogInformation("Worker running at: {time}", DateTime.Now);

                await Task.CompletedTask;
            }, stoppingToken);

            await Task.Delay(_crontab.GetSleepTimeSpan(DateTime.Now), stoppingToken);
        }
    }
}
```

## 26.2.7 `Crontab` å¯¹è±¡å±æ€§å’Œæ–¹æ³•

```cs showLineNumbers {1,4,14,27}
// å®ä¾‹å±æ€§
var format = crontab.Format;  // è·å–å½“å‰æ ¼å¼åŒ–é…ç½®

// é™æ€å±æ€§
var secondly = Crontab.Secondly;    // æ¯ç§’ .0000000
var minutely = Crontab.Minutely;    // æ¯åˆ†é’Ÿ 00
var hourly = Crontab.Hourly;    // æ¯å°æ—¶ 00:00
var daily = Crontab.Daily;  // æ¯å¤© 00:00:00
var monthly = Crontab.Monthly;  // æ¯æœˆ 1 å· 00:00:00
var weekly = Crontab.Weekly;    // æ¯å‘¨æ—¥ 00ï¼š00ï¼š00
var yearly = Crontab.Yearly;    // æ¯å¹´ 1 æœˆ 1 å· 00:00:00
var workday = Crontab.Workday;    // æ¯å‘¨ä¸€è‡³å‘¨äº” 00:00:00

// å®ä¾‹æ–¹æ³•
// è·å–ä¸‹ä¸€ä¸ªæ‰§è¡Œæ—¶é—´
var nextOccurrence = crontab.GetNextOccurrence(èµ·å§‹æ—¶é—´);
var nextOccurrence = crontab.GetNewDbContext(èµ·å§‹æ—¶é—´, ç»“æŸæ—¶é—´);
// è·å–ç‰¹å®šæ—¶é—´æ‰€æœ‰æ‰§è¡Œæ‰§è¡Œæ—¶é—´
var nextOccurrences = crontab.GetNextOccurrences(èµ·å§‹æ—¶é—´, ç»“æŸæ—¶é—´);
// è·å–å½“å‰æ—¶é—´å’Œä¸‹ä¸€ä¸ªå‘ç”Ÿæ—¶é—´ç›¸å·®æ¯«ç§’æ•°
var sleepMilliseconds = crontab.GetSleepMilliseconds(èµ·å§‹æ—¶é—´);
// è·å–å½“å‰æ—¶é—´å’Œä¸‹ä¸€ä¸ªå‘ç”Ÿæ—¶é—´ç›¸å·®æ—¶é—´æˆ³
var sleepTimeSpan = crontab.GetSleepTimeSpan(èµ·å§‹æ—¶é—´); // Furion 4.8.4.10+ ç‰ˆæœ¬æœ‰æ•ˆ
// å°† crontab å¯¹è±¡è½¬æ¢æˆ cron è¡¨è¾¾å¼
var expression = crontab.ToString();

// é™æ€æ–¹æ³•
// è§£æè¡¨è¾¾å¼
var crontab = Crontab.Parse("è¡¨è¾¾å¼", CronStringFormat.Default);  // è½¬æ¢è¡¨è¾¾å¼ä¸º Crontab å¯¹è±¡
var crontab = Crontab.TryParse("è¡¨è¾¾å¼", CronStringFormat.Default);  // è½¬æ¢è¡¨è¾¾å¼ä¸º Crontab å¯¹è±¡
var crontab = Crontab.ParseAt("Macro ç¬¦å·", 1, 3, 5);   // åˆ›å»º Macro At Crontab å¯¹è±¡
var isValid = Crontab.IsValid("è¡¨è¾¾å¼", CronStringFormat.Default);  // åˆ¤æ–­è¡¨è¾¾å¼æ˜¯å¦æœ‰æ•ˆï¼ŒFurion 4.8.7.17+ æ”¯æŒ

// æ¯ç¬¬ 3 ç§’
var crontab = Crontab.SecondlyAt(3);
// æ¯ç¬¬ 3ï¼Œ5ï¼Œ6 ç§’
var crontab = Crontab.SecondlyAt(3, 5, 6);

// æ¯åˆ†é’Ÿç¬¬ 3 ç§’
var crontab = Crontab.MinutelyAt(3);
// æ¯åˆ†é’Ÿç¬¬ 3ï¼Œ5ï¼Œ6 ç§’
var crontab = Crontab.MinutelyAt(3, 5, 6);

// æ¯å°æ—¶ç¬¬ 3 åˆ†é’Ÿ
var crontab = Crontab.HourlyAt(3);
// æ¯å°æ—¶ç¬¬ 3ï¼Œ5ï¼Œ6 åˆ†é’Ÿ
var crontab = Crontab.HourlyAt(3, 5, 6);

// æ¯å¤©ç¬¬ 3 å°æ—¶æ­£ï¼ˆç‚¹ï¼‰
var crontab = Crontab.DailyAt(3);
// æ¯å¤©ç¬¬ 3ï¼Œ5ï¼Œ6 å°æ—¶æ­£ï¼ˆç‚¹ï¼‰
var crontab = Crontab.DailyAt(3, 5, 6);

// æ¯æœˆç¬¬ 3 å¤©é›¶ç‚¹æ­£
var crontab = Crontab.MonthlyAt(3);
// æ¯æœˆç¬¬ 3ï¼Œ5ï¼Œ6 å¤©é›¶ç‚¹æ­£
var crontab = Crontab.MonthlyAt(3, 5, 6);

// æ¯å‘¨æ˜ŸæœŸ 3 é›¶ç‚¹æ­£
var crontab = Crontab.WeeklyAt(3);
var crontab = Crontab.WeeklyAt("WED");  // SUNï¼ˆæ˜ŸæœŸå¤©ï¼‰ï¼ŒMONï¼ŒTUEï¼ŒWEDï¼ŒTHUï¼ŒFRIï¼ŒSAT
// æ¯å‘¨æ˜ŸæœŸ 3ï¼Œ5ï¼Œ6 é›¶ç‚¹æ­£
var crontab = Crontab.WeeklyAt(3, 5, 6);
var crontab = Crontab.WeeklyAt("WED", "FRI", "SAT");
// è¿˜æ”¯æŒæ··åˆ
var crontab = Crontab.WeeklyAt(3, "FRI", 6);

// æ¯å¹´ç¬¬ 3 æœˆ 1 æ—¥é›¶ç‚¹æ­£
var crontab = Crontab.YearlyAt(3);
var crontab = Crontab.YearlyAt("MAR");  // JANï¼ˆä¸€æœˆï¼‰ï¼ŒFEBï¼ŒMARï¼ŒAPRï¼ŒMAYï¼ŒJUNï¼ŒJULï¼ŒAUGï¼ŒSEPï¼ŒOCTï¼ŒNOVï¼ŒDEC
// æ¯å¹´ç¬¬ 3ï¼Œ5ï¼Œ6 æœˆ 1 æ—¥é›¶ç‚¹æ­£
var crontab = Crontab.YearlyAt(3);
var crontab = Crontab.YearlyAt(3, 5, 6);
var crontab = Crontab.YearlyAt("MAR", "MAY", "JUN");
// è¿˜æ”¯æŒæ··åˆ
var crontab = Crontab.YearlyAt(3, "MAY", 6);
```

## 26.2.8 åé¦ˆä¸å»ºè®®

:::note ä¸æˆ‘ä»¬äº¤æµ

ç»™ Furion æ [Issue](https://gitee.com/dotnetchina/Furion/issues/new?issue)ã€‚

:::
